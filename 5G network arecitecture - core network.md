# Access and mobality management function(AMF)

<img width="1440" alt="Screenshot 2023-11-29 at 7 44 14 PM" src="https://github.com/dhirukumar/Technologies-Architecture-and-protocol/assets/146316525/2e60261f-63d1-42a0-994c-d9cc1bcec365">

- 5G core network divided into many function as you see in this diagram
## 1st function

- AMF=It is very similar to MME in LTE (4G) or VLR in GSM(Global system for mobile communication)(2G)

- When a UE switch on then their first process to register with the network and this registration function is done by the AMF

- Before register in AMF you needs to authentication and this authentication is initiated by AMF weather this user is valid or not

- UE has always in two type of modes

   - Ideal mode:- in this mode UE register with network but UE not on call in that case the location of this UE is know to the network at the tracking area level

       - Tracking area:- the cell in the 5G network divided into the tracking area a group of cell has one tracking area and another group of cell has another tracking area

- So, when a UE in ideal mode and UE change there tracking area in this case UE needs to update their tracking area so this function is also handling by AMF

- When a  UE on call  in this case you will change their tracking area so you has also need to update there tracking area so this function is also handling by AMF

# authentication server function (AUSF)

## 2nd function
<img width="1440" alt="Screenshot 2023-11-29 at 8 29 54 PM" src="https://github.com/dhirukumar/Technologies-Architecture-and-protocol/assets/146316525/0e4fc1f4-4a07-40be-b7f1-537130c01a1c">

- When a UE want to register with AMF to make a call it needs to be authenticated and this authentication is initiated by AMF but in order to complete this authentication process to other entity are also needed one is UDM and another is AUSF

- Whenever AMF initiated the authentication process it basically send the identity of UE to AUSF and AUSF request UDM to generate the authentication vector this authentication vector generated by the UDM by the help of this identity of UE besed upon this secret key that is weather with the UDM after that authentication vector pass to the AUSF and it also pass this authentication vector to AMF

- Now with in this authentication vector there is a random number and AMF challenging the UE with the random number by sending it to the UE after receiving this authentication vector to UE  generate authentication response which goes to the AMF and pass on to the AUSF and AUSF check it is valid authentication response or not based upon that AUSF decision that whether this UE is authenticated or not

 # session management function (SMF)
<img width="1440" alt="Screenshot 2023-11-30 at 10 20 59 AM" src="https://github.com/dhirukumar/Technologies-Architecture-and-protocol/assets/146316525/89a1c119-7bf8-4b60-9fc6-50eaa43000b0">

- If a UE wants to use data then it's need PDU session with the 5G network so this establishment and management of PDU session is handled by SMF

- As a part of PDU establishment SMS need to coordinate with PCF

- PCF decide that under the network circumstances network condition weather the PDU session is established or with what quality of service is established it is decided by QOS session establishment decided by the PCF

- SMS also co-ordinate with the UPF

- SMF select UPF with which UE established the PDU session there maybe more than one UPF and similarly for the establishment of PDU session SMS actively coordinate with UPF

- As a part of PDU session SMF needs to  allocate IP address to UE so this allocation is also done by the  SMF

- The SMF in 5G network is very similar to the PDN-GW (gateway) control plane in LTE (4G)


# User plane function(UPF)
<img width="1440" alt="Screenshot 2023-11-30 at 3 15 57 PM" src="https://github.com/dhirukumar/Technologies-Architecture-and-protocol/assets/146316525/9b113fc7-899c-4f59-b13a-bd1e0fbdc7aa">

- UPF is very important part of 5G network it is important because UPF is the point of contact of data network with 5G core Network and whenever a data packet arrive from the data network it is UPF that decides when the packet needs to be rotate

- UPF is anchor for the UE

- Anchor for UE means UPF  build PDU session between UE and UPF and when you move to one gNB area to another gNB so PDU session is always build

- I already mention the QOS decision is taken by PCF and this information is taken to SMF and SMF intimated this information to UPF and UPF is responsible for enforcement this QOS is decision done by the UPF Hence UPF enforced QOS in PDU session

- The function of UPF in 5G core network is very similar to PDN GW(gateway) data plane in Ltd (4G)

# unified data management (UDM)

<img width="1440" alt="Screenshot 2023-11-30 at 3 47 55 PM" src="https://github.com/dhirukumar/Technologies-Architecture-and-protocol/assets/146316525/2b0493a5-d5dd-4923-ab91-06311f920ada">

- UDM is another very important function in 5G core network

- It is centralised database for all the subscriber information in 5G network so the proper function of UDM is very important

- UDM has inter database and also have external database called you UDR (unified data repository)

- UDR is important Because UDR holds key authentication for authenticate UE wether they can use our network or not

- When a UE change their tracking area they have also need to change their AMF so UDR is responsible for identify that in which AMF area this UE is located so this function is done in UDR

- UDM Holds the subscriber information like in the following

   - What type of data service is subscriber can use and at what quality of service that he can use
 
   - Which service user can access and which service user cannot access
 
   - UDM has also know user can restricted in certain tracking area
 
   - When a user coming from another service provider and they want to use your services so they are allowed or not allowed

- it is very simeler to HSS in LTE (4G) and HLR in GSM

# policy charging function (PCF)
<img width="1440" alt="Screenshot 2023-11-30 at 4 29 38 PM" src="https://github.com/dhirukumar/Technologies-Architecture-and-protocol/assets/146316525/c064b7b4-6567-47de-9260-7d327bfceb8c">

- PCF is involved in dynamic policy decision based upon network condition such as congestion and subscriber geo-location

- `For example or UV ra mobile where located in gnb have bad channel condition and this UV wants a call so this request of call would reach to pcf through the SMS now here pcf make two decision`

     - First decision = throttle the data of this UA so it can make a video call
 
     - Second decision = it refuse the call all together with the help of AMF
 
- PCF also involved in manage of service area

    - Service area for UE is list of a allowed or not allowed tracking area (TA's)
 
- There are always two case in PCF in the following

     - first case if a user in tracking area that is not allowed for him and if this UE wants make a call then PCF interact with AMF and then it can refuse call all together

     - second case if a user in tracking area that is allowed for him and if this UE want make a call then PCF allowed the call

- when a UE in 5G network and they wants to make a call what charges that is also decided by PCF charging depend upon what service of quality UE use

- It is very similar to PCRF in LTE (4G)













  

  
